(.venv) hkhoshnoud@miXtile:~/srt205/repo/srt205-project$ ansible-playbook -i inventory/hosts.ini site.yml -e "cis_mode=audit"

PLAY [CIS Ubuntu] ***************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] **********************************************************************************************************************************************************************************************************
[WARNING]: Platform linux on host db_node01 is using the discovered Python interpreter at /usr/bin/python3.12, but future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.18/reference_appendices/interpreter_discovery.html for more information.
ok: [db_node01]

TASK [cis_ubuntu : Install baseline packages (pwquality, auditd, ufw, rsyslog, unattended-upgrades)] ****************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit baseline packages presence] ****************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Record missing baseline packages (audit)] ********************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Configure password aging in /etc/login.defs] *****************************************************************************************************************************************************************
skipping: [db_node01] => (item={'key': 'PASS_MAX_DAYS', 'value': 90}) 
skipping: [db_node01] => (item={'key': 'PASS_MIN_DAYS', 'value': 1}) 
skipping: [db_node01] => (item={'key': 'PASS_WARN_AGE', 'value': 7}) 
skipping: [db_node01]

TASK [cis_ubuntu : Audit password aging values] *********************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Configure pwquality minimums] ********************************************************************************************************************************************************************************
skipping: [db_node01] => (item={'key': 'minlen', 'value': 12}) 
skipping: [db_node01] => (item={'key': 'dcredit', 'value': -1}) 
skipping: [db_node01] => (item={'key': 'ucredit', 'value': -1}) 
skipping: [db_node01] => (item={'key': 'lcredit', 'value': -1}) 
skipping: [db_node01] => (item={'key': 'ocredit', 'value': -1}) 
skipping: [db_node01] => (item={'key': 'retry', 'value': 3}) 
skipping: [db_node01]

TASK [cis_ubuntu : Audit pwquality.conf] ****************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Ensure sudo logging is configured via drop-in] ***************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Ensure sudo log file exists with secure perms] ***************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit sudo logging] ******************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Template hardened sshd drop-in] ******************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Audit sshd effective settings] *******************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Normalize sshd audit lines for report] ***********************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Ensure ASLR is enabled] **************************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Restrict core dumps] *****************************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Restrict ptrace_scope] ***************************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit kernel/sysctl hardening] *******************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Ensure auditd is enabled and running] ************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Ensure rsyslog is enabled and running] ***********************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Ensure unattended-upgrades service is enabled] ***************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Check UFW status (verbose)] **********************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Reset UFW rules (only when needed)] **************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Set default deny inbound] ************************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Allow SSH port] **********************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Enable UFW (only if inactive)] *******************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit UFW status] ********************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Remove cron.deny and at.deny] ********************************************************************************************************************************************************************************
skipping: [db_node01] => (item=/etc/cron.deny) 
skipping: [db_node01] => (item=/etc/at.deny) 
skipping: [db_node01]

TASK [cis_ubuntu : Ensure cron.allow exists and only allows root] ***************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Ensure at.allow exists and only allows root] *****************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit cron/at allow/deny] ************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Check if /tmp has an fstab entry] ****************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Update /tmp options in /etc/fstab to include nodev,nosuid,noexec] ********************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Remount /tmp with secure options] ****************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit /tmp mount options] ************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Enable and start systemd-timesyncd] **************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Disable/stop chrony if present] ******************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Disable/stop ntp if present] *********************************************************************************************************************************************************************************
skipping: [db_node01]

TASK [cis_ubuntu : Audit time sync services] ************************************************************************************************************************************************************************************
ok: [db_node01]

TASK [cis_ubuntu : Build audit summary (controller-side print)] *****************************************************************************************************************************************************************
ok: [db_node01] => {
    "msg": {
        "cron_at": [],
        "login_defs": [
            "PASS_MAX_DAYS\t90",
            "PASS_MIN_DAYS\t1",
            "PASS_WARN_AGE\t7"
        ],
        "missing_packages": [],
        "mode": "audit",
        "pwquality": [
            "minlen = 12",
            "dcredit = -1",
            "ucredit = -1",
            "lcredit = -1",
            "ocredit = -1",
            "retry = 3"
        ],
        "sshd": [],
        "sudo_log": [],
        "sysctl": [
            "kernel.randomize_va_space = 2",
            "fs.suid_dumpable = 0",
            "kernel.yama.ptrace_scope = 1"
        ],
        "timesync": [
            "enabled",
            "active",
            "not-found",
            "not-found"
        ],
        "tmp_mount": [],
        "ufw": []
    }
}

TASK [audit_compliance : Ensure report directory exists (controller)] ***********************************************************************************************************************************************************
changed: [db_node01 -> localhost]

TASK [audit_compliance : Render compliance report (controller)] *****************************************************************************************************************************************************************
changed: [db_node01 -> localhost]

TASK [audit_compliance : Show report path (controller)] *************************************************************************************************************************************************************************
ok: [db_node01 -> localhost] => {
    "msg": "Report: /home/hkhoshnoud/srt205/repo/srt205-project/reports/compliance_report_db_node01_2025-08-15.md"
}

PLAY RECAP **********************************************************************************************************************************************************************************************************************
db_node01                  : ok=24   changed=2    unreachable=0    failed=0    skipped=19   rescued=0    ignored=0   

(.venv) hkhoshnoud@miXtile:~/srt205/repo/srt205-project$ ls -l reports
sed -n '1,80p' reports/compliance_report_db_node01_$(date +%F).md
.rw-r--r-- hkhoshnoud hkhoshnoud 615 B Thu Aug 14 23:59:49 2025 î˜‰ compliance_report_db_node01_2025-08-15.md
sed: can't read reports/compliance_report_db_node01_2025-08-14.md: No such file or directory
